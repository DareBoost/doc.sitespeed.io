---
layout: default
title: Documentation - Sitespeed.io
description: Here's the documentation of sitespeed.io, the workflow, how you run it and how you use it as a developer.
keywords: documentation, workflow, sitespeed.io, jenkins, navigation timing api
author: Peter Hedenskog
nav: documentation
image: http://www.sitespeed.io/img/sitespeed-2.0-twitter.png
twitterdescription: Add your own rules to sitespeed.io is easy, because of the use of YSlow as the rule engine. Read here how you do it!
---
 <div class="row">
    <div class="col-lg-12"> 
      <div class="page-header">
  <h1>
    Documentation
  </h1>
</div>  
<ol id="toc">
  <li class="toc"><a href="#introduction">Introduction</a></li>
  <li class="toc"><a href="#installation">Download and installation</a></li> 
  <li class="toc"><a href="#analyzeonesite">Analyze a site</a></li>
  <ul>
    <li class="toc"><a href="#workflow">The workflow</a></li> 
    <li class="toc"><a href="#configuration">Configuration</a></li>
    <ul>
      <li class="toc"><a href="#theoptions">The options</a></li>
      <li class="toc"><a href="#basic">The basics</a></li>
      <ul>
        <li class="toc"><a href="#analyzebycrawling">Analyze by crawling</a></li>
        <li class="toc"><a href="#analyzebyurls">Analyze by URL:s</a></li>
        <li class="toc"><a href="#includeexclude">Include/exclude URL:s when crawling</a></li>
        <li class="toc"><a href="#screenshots">Screenshots</a></li>
        <li class="toc"><a href="#mobile">Analyze as mobile</a></li>
        <li class="toc"><a href="#limitpages">Limit pages to test</a></li>
        <li class="toc"><a href="#rules">Choose desktop or mobile rules</a></li>
        <li class="toc"><a href="#browsertimemetrics">Collect Browser timings a.k.a fetch Navigation Timing data</a></li>
         <li class="toc"><a href="#config-boxes">Boxes on summary page</a></li>
        <li class="toc"><a href="#config-columns">Columns on pages</a></li>
      </ul>
      <li class="toc"><a href="#advanced">Advanced</a></li>
      <ul>
        <li class="toc"><a href="#processes">Changing the number of processes analyzing the site</a></li>
        <li class="toc"><a href="#resultdir">Change the result directory</a></li>
        <li class="toc"><a href="#heap">Heap size for the Java applications</a></li>
        <li class="toc"><a href="#proxy">Run behind a proxy</a></li>
      </ul>
    </ul>
   </ul>
   <li class="toc"><a href="#multiple">Analyze & compare multiple sites</a></li>
  <ul>
    <li class="toc"><a href="#summarypage">Configuration</a></li>
      <ul>
        <li class="toc"><a href="#summarypage">Basic configuration</a></li>
        <li class="toc"><a href="#summarypage">Choose columns for report</a></li>
      </ul>
   </ul>
    <li class="toc"><a href="#browsertime">Collect Browser timings</a></li>
   <li class="toc"><a href="#summaryxml">The summary.xml file</a></li>
  <li  class="toc"><a href="#harfiles">HAR files</a></li>

   <li class="toc"><a href="#continuousintegration">Continuous integration</a></li>
  <ul>
     <li class="toc"><a href="#junit">Generating the JUnit XML for continuous integration</a></li>
      <li class="toc"><a href="#jenkins">Jenkins integration</a></li>
  <li class="toc"><a href="#travis">Travis integration</a></li>
</ul>
 <li class="toc"><a href="#developers">Developers</a></li>
  <ul>
  <li class="toc"><a href="#dependencies">Dependencies</a></li>
     <li class="toc"><a href="#components">Components</a></li>
     <li class="toc"><a href="#feature">Create a new feature request</a></li>
     <li class="toc"><a href="#bug">Report a bug</a></li>
     <li class="toc"><a href="#configurerulelimits">Configure rule limits</a></li>
     <li class="toc"><a href="#createboxes">Create your own box on the summary page</a></li>
     <li class="toc"><a href="#createcolumns">Create your column for the pages table</a></li>
     <li class="toc"><a href="#addrule">Add your own rules</a></li>
   </ul>
 </ol>


 <div class="section" id="introduction">
  <div class="page-header">
      <h1>Introduction</h1>
    </div>
    <p>Sitespeed.io is an open source tool that will check your site against web performance best practice rules and use the <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html" target="_blank">Navigation Timing API</a> to collect metrics. It will create XML & HTML output of the result.
    </p>
 </div>


<div class="section" id="installation">

      <div class="page-header">
      <h1>Download and installation</h1>
    </div>

      {% include installation.html %}
      
      <p>If you are using Windows, you need to install <a href="https://code.google.com/p/msysgit/downloads/list?q=label:Featured" target="_blank">Git Bash</a>.</p>

    </div>

<div class="section" id="analyzeonesite">

      <div class="page-header">
      <h1>Analyze a site</h1>
    </div>
    <p>You can choose to analyze one site or multiple sites & compare them. Here's the workflow when analyzing one site. 
      </p>
    </div>

<div class="section">
      <div class="page-header">
      <h2 id="workflow">The workflow</h2>
      </div>
      <p>This is what will happen when you start the script:
  </p>
        <pre class="bash">$ ./sitespeed.io -u http://www.cybercom.com/en/</pre>
          <p>
        The script will log what is happening, it will look something like this:
  </p>
    <pre>
$ Will crawl from start point http://www.cybercom.com/en/ with User-Agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.71 Safari/537.36 and viewport 1280x800 with crawl depth 1 using ruleset sitespeed.io-2.0-desktop ... this can take a while
$ Using PhantomJS version 1.9.1
$ Using Java version 1.6.0_27
$ Will analyze 19 pages
$ Analyzing http://www.cybercom.com/en/
$ Analyzing http://www.cybercom.com/fi/Suomi/
$ ...
$ Create all the result pages
$ Create result.xml
$ Create the summary.xml
$ Create the summary-details.html
$ Create the pages.html
$ Create the summary index.html
$ Create the assets.html
$ Create the rules.html
$ Finished analyzing www.cybercom.com
</pre>

      <p>
        It will create the following directory structure (the first directory is named after the site you are testing and when the test was executed):
  </p>
        <pre>
sitespeed-result
|
`--www.cybercom.com
    `
    2013-10-02-19-14-59
    |
    | -- assets.html
    | -- css
    |
    | -- data
      | -- errorurls.xml
      | -- har
      | -- metrics
      | -- pages 
      | -- result.xml
      ` -- summary.xml
    |
    | -- img
    | -- (images)
    |
    | -- js
    |
    | -- pages
    |
    | -- pages.html
    | -- rules.html
    | -- screenshots
    | -- screenshots.html    
    | -- summary-details.html
    | -- (errorurls.html)
    ` -- index.html
</pre>

      <p>
        The <strong>data</strong>
        directory hold all the raw data files that's the result from the analyze. The <strong>errorurls.xml</strong> contains URL:s that couldn't be fetched. The <strong>har</strong> directory holds all the HAR-files produced when testing the pages. The <strong>metrics</strong> contains Browser Time XML, the metrics collected from the Navigation Timing API. The <strong>result.xml</strong> contains all the analyzed data for all pages. The 
        <strong>summary.xml</strong> is the XML representation of all the tests (that is used in the summary page).
         <strong>Pages</strong>
        hold the result (as HTML) for all unique page tests. The
        <strong>pages.html</strong>
        is all pages data, summarized in one page.  The
        <strong>index.html</strong>
        is the summary page, holding information on a high level. Then the <strong>summary-details.html</strong> holds the summary info on a detailed level, here you will see the nitti gritty details of the site.
        <strong>rules.html</strong> is a presentation of the rules used to calculate the score for a page. And the images folder is created if you choose to output the summary as png:s. The <strong>errorurls.html</strong> shows the list of URL:s that couldn't be fetched (the file will not exist if all url:s could be collected).
        The <strong>assets.html</strong> shows the top 200 most used assets across the pages.
      </p>
</div>

<div class="section">

      <h2 id="summarypage">Site summary page</h2>
      <p>
        Sitespeed.io creates a couple of different views/outputs. The summary page is a executive summary page where green is good, yellow means that you should look into it and red is bad (sometimes really bad). The page shows a summary of best practices for good web site performance (and site speed metrics if configured). You can choose which boxes/best practices that will be shown on this page, so you can create different views for different use cases.
      </p>
     <p class="text-center">
        <img src="/img/summary-2.0.jpg" alt="sitespeed.io summary page" class="img-thumbnail img-responsive"/>
      </p>
</div>

<div class="section">

      <h2 id="detailedsummarypage">The detailed summary page</h2>
      <p>
        The detailed summary page will give you almost all the metrics you want for you site. You will get the average, 10th percentile, median, 95th percentile, min, max and standard deviation value for each metrics (this page is based on the <strong>summary.xml</strong> file, where you also will find the variance and the 90th percentile, if ever needed when comparing metrics). 
      </p>
      <p class="text-center">
        <img src="/img/summary-details-2.0.png" alt="sitespeed summary page" class="img-thumbnail img-responsive"/>
      </p>
</div>


<div class="section">

      <h2 id="pages">Detailed site report</h2>
      <p>
        The detailed site report page shows data collected for each page. You can configure which metrics/data that you want to show in the columns, so you can choose what is extra important for you.
      </p>
      <p class="text-center">
        <img src="/img/pages-2.0.jpg" alt="sitespeed pages page" class="img-thumbnail"/>
  </p>
</div>

<div class="section">

      <h2 id="page">Full page analyzes</h2>
      <p>
      Every page that is tested, also get a corresponding HTML page, where all in deep data is shown. Checkout the <a href="/example/">examples</a> section to see what it looks like.
    </p>
    <p class="text-center">
      <img src="/img/page-2.0.jpg" alt="sitespeed page page" class="img-thumbnail"/>
     </p>


</div>

<div class="section">


      <h2 id="assets">Most used assets report</h2>
      <p>
        The most used assets report show you the most used assets (a.k.a which asset should you start to change to get the most bang for the money).
        You will see the following for each asset: the type, the time since last modification, the cache time, the weight and the number of times the asset has been used.</p>
      <p class="text-center">
        <img src="/img/assets-2.0.jpg" alt="sitespeed most used asset page" class="img-thumbnail"/>
      </p>

</div>

<div class="section">
      <h2 id="screenshots">Screenshots</h2>
      <p>
       You can choose to take screenshots of every tested page for the used viewport.</p>
      <p class="text-center">
        <img src="/img/screenshots-2.0.jpg" alt="sitespeed.io screenshot page" class="img-thumbnail"/>
      </p>

</div>



<div class="section" id="configuration">

      <div class="page-header">
      <h2>Configuration</h2>
    </div>
    <p>Sitespeed.io is highly configurable, both what you can do and what you will see. Let's check it out!</p>
  </div>

<div class="section" id="theoptions">

      <div class="page-header">
      <h2>The options</h2>
    </div>

<p>You have the following options running sitespeed.io:</p>
<pre>
usage: ./sitespeed.io options

OPTIONS:
   -h      Help
   -u      The start URL of the crawl: http[s]://host[:port][/path/]. Use this or use the -f file option.
   -f      The path to a plain text file with one URL on each row.
   -d      The crawl depth, default is 1 (one page and all links pointing to the same domain on that page) [optional]
   -q      Crawl URLs only URLs that contains this keyword in the path [optional]
   -s      Skip URLs that contains this keyword in the path [optional]
   -p      The number of processes that will analyze pages, default is 5 [optional]
   -m      The memory heap size for the Java applications, default is 1024 Mb [optional]
   -n      Give your test a name, it will be added to all HTML pages [optional]
   -o      The output format, always output as HTML and you can also output a CSV file for the detailed site summary page  (csv) [optional]
   -r      The result base directory, default is sitespeed-result [optional]
   -x      The proxy host & protocol: proxy.soulgalore.com:80 [optional] 
   -t      The proxy type, default is http [optional]
   -a      The full User Agent string, default is Chrome for MacOSX. You can also set the value as iphone or ipad (will automagically change the viewport) [optional]
   -v      The view port, the page viewport size WidthxHeight, like 400x300, default is 1280x800 [optional] 
   -y      The compiled YSlow file, default is dependencies/yslow-3.1.5-sitespeed.js [optional]
   -l      Which ruleset to use, default is the latest sitespeed.io version for desktop [optional]
   -g      The columns showed on detailed page summary table, see http://www.sitespeed.io/documentation/#config-columns for more info [optional] 
   -b      The boxes showed on site summary page, see http://www.sitespeed.io/documentation/#config-boxes for more info [optional]
   -j      The max number of pages to test [optional]   
   -k      Take screenshots for each page (using the configured view port). Default is false. (true|false) [optional] 
   -c      Collect BrowserTimings data (meaning open a real browser & fetch timings). Default is false. (true|false) [optional] 
   -z      String sent to BrowserTime, so you can choose browser and tries. Default is "-b firefox -n 3".
</pre>

</div>


<div class="section" id="basic">
    <div class="page-header">
    <h2>The basics</h2>
  </div>

<p>You can analyze a site either by crawling or feed sitespeed.io with the URL:s you want to analyze.
</p>
</div>

<div class="section" id="analyzebycrawling">
    <div class="page-header">
    <h2>Analyze by crawling</h2>
</div>
<p>The crawler need a start URL (the parameter <strong>u</strong>, from where it will start the crawl. It will fetch all links within the same domain as the URL that you provide. You can then choose how deep you want to crawl with the <strong>i</strong> parameter. Zero will fetch only that 
  URL that you provide. One will fetch all links on that page and analyze these, two will go one level deeper and so on. If you want to analyze a site and the links with a depth of four, you do like this:
</p>
<pre class="bash">$ ./sitespeed.io -u http://www.yoursite.com -d 4</pre>

<div class="note note-info">Remember that you can start your crawl deep into your path structure like <strong>http://yoursite.com/my/path</strong>.</div>
</div>


<div class="section" id="analyzebyurls">
    <div class="page-header">
    <h2>Analyze by URL:s</h2>
</div>
<p>Instead of giving a start URL for the crawl, you can supply a plain text file with one URL on each row. Then each of these URL will be analyzed, no more or no less. A file like this will do:</p>

<pre>
http://www.yoursite.com/path/
http://www.yoursite.com/my/really/important/page/
http://www.yoursite.com/where/we/are/
</pre>
<p>Then you feed the file to the script:</p>
<pre class="bash">$ ./sitespeed.io -f myurls.txt</pre>
<div class="note note-info">This is good for testing and keep track of your site in production and you have a LARGE site with many pages and a couple of them are more important than the rest. </div>
</div>

<div class="section" id="includeexclude">
    <div class="page-header">
    <h2>Include/exclude URL:s when crawling</h2>
</div>
<p>You want to make sure that parts of your site isn't included in your analyze, then you can add the parameter <strong>s</strong> and a keyword. Every URL with that keyword will not be included.</p>
 <pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -s /monkey/</pre>
<p>You can also do it the other way around, with the <strong>q</strong> and a keyword. In this case, the analyze will only include URL:s with the keyword.</p>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -q /the/path/</pre>
</div>

<div class="section" id="screenshots">
    <div class="page-header">
 <h2>Screenshots</h2>
</div>
<p>You can get screenshots of every page that you analyze. These will end up on a screenshot page where you can check them all. The screenshots will be taken for the chosen viewport.
</p>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -k true</pre>

<div class="note note-info">If you have <em>pngcrush</em> installed on your system, the screenshots file size will be reduced.</div>

</div>

<div class="section" id="mobile">
    <div class="page-header">
 <h2>Viewport/user agent & mobile</h2>
</div>
<p>You can set the viewport & user agent, so that you can fake testing a site as a mobile device.</p>

<p>By default the viewport is 1280x800 with the folowing user agent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.71 Safari/537.36" 
(that is Chrome on MacOSX).</p>

<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -v 400x300 -a "My SUPER BROWSER"</pre>

<div class="note note-info">
You can set the user agent to <strong>iphone5</strong>, <strong>nexus</strong> or <strong>ipad</strong> That will automatically set the viewport to 320x444 or 768x1024 and set the Safari or Chrome user agent.
</div>
</div>


<div class="section" id="limitpages">
    <div class="page-header">
 <h2>Limit pages to test</h2>
</div>
<p>Sometimes you want to limit the amount to test (I do that when I compare sites). That will test maximum the amount of pages ju supply.</p>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -j 10</pre>
</div>

<div class="section" id="rules">
    <div class="page-header">
 <h2>Choose desktop or mobile rules</h2>
</div>
<p>By default you can choose between sitespeed.io desktop rules or mobile rules.</p>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -l sitespeed.io-2.0-desktop</pre>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -l sitespeed.io-2.0-mobile</pre>
</div>


<div class="section" id="name">
    <div class="page-header">
 <h2>Set a name of your test</h2>
</div>
    <p>You can give your test run a name, that will be showed on all the pages.</p>
    <pre class="bash">$ ./sitespeed.io -u http://yoursite.com/ -n "Swedens top 100 sites"</pre>
</div>

<div class="section" id="browsertimemetrics">
    <div class="page-header">
 <h2>Collect Browser Time metrics</h2>
</div>
<p>By default, the collecting of timing metrics is turned off, so you need to turn it on.</p>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -c true</pre>

<p>Firefox is used to collect metrics for each page. Each page is tested 3 times. You can change that with the <em>z</em> parameter. That full String is sent to the Browser Time application (more documentation <a href="https://github.com/tobli/browsertime" target="_blank">here</a>). Changing it to Chrome and test each page 5 times, looks like this:</p>

<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -c true "-b chrome -n 5"</pre>

<div class="note note-warning">To run Chrome, you need to have the ChromeDriver installed on your computer, you can find more info <a href="https://code.google.com/p/chromedriver/" target="_blank">here</a>.</div>
</div>

<div class="section" id="config-boxes">
    <div class="page-header">
 <h2>Boxes on summary page</h2>
</div>
<p>You can choose (and <a href="#createbox">create</a> your own) boxes you want to show on the summary page. You will see a couple of boxes by default (and when running BrowserTime you will also have some timing boxes). If you want to change boxes, you do that with the parameter <em>b</em> and comma separated list of the name of the boxes. The boxes are generated from the summary.xml file, meaning you can show whatever kind of data you want, as long as it exists in the summary xml file. </p>
<p>For example, you want to focus on images, and only want to show image data:</p>
<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -b imagesPerPage,imageWeight,imageWeightPerPage</pre>

<p>That will generate a summary page with the following three boxes:</p>

<p class="text-center">
        <img class="img-responsive img-thumbnail" alt="sitespeed.io image boxes" src="/img/images-boxes.png"/>
</p>

<p>You can choose by the between the following summary boxes (by specifying the name):</p>

<table class="table table-condensed table-striped table-bordered table-small">
  <thead>
    <tr>
    <th>name</th><th>info</th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td>jsPerPage</td><td>Number of JS</td>
    </tr>
<tr>
      <td>cssPerPage</td><td>Number of CSS</td>
    </tr>
<tr>
      <td>imagesPerPage</td><td>Number of images</td>
    </tr>
<tr>
      <td>cssImagesPerPage</td><td>Number of CSS images</td>
    </tr>
<tr>
      <td>request</td><td>Number of requests</td>
    </tr>
<tr>
      <td>pageWeight</td><td>Total page weight</td>
    </tr>
<tr>
      <td>imageWeight</td><td>Image weight</td>
    </tr>
<tr>
      <td>jsWeight</td><td>JS weight</td>
    </tr>
<tr>
      <td>cssWeight</td><td>CSS weight</td>
    </tr>
<tr>
      <td>imageWeightPerPage</td><td>Total images weight per page</td>
    </tr>
<tr>
      <td>cssWeightPerPage</td><td>CSS weight per page</td>
    </tr>
<tr>
      <td>jsWeightPerPage</td><td>JS weight per page</td>
    </tr>
<tr>
      <td>ruleScore</td><td>Rule score</td>
    </tr>
<tr>
      <td>docWeight</td><td>Document weight</td>
    </tr>
<tr>
      <td>spofPerPage</td><td>Number of SPOF per page</td>
    </tr>
<tr>
      <td>spofPages</td><td>Pages with SPOF</td>
    </tr>
<tr>
      <td>browserScaledImages</td><td>Images scaled by the browser</td>
    </tr>
<tr>
      <td>jsSyncInHead</td><td>Number of JS synchronously in head</td>
    </tr>
<tr>
      <td>requestsWithoutExpires</td><td>Requests without expires</td>
    </tr>
<tr>
      <td>criticalPathScore</td><td>Critical Rendering Path Score</td>
    </tr>
<tr>
      <td>textContent</td><td>Amount of text content</td>
    </tr>
<tr>
      <td>timeSinceLastModification</td><td>Time since last modification</td>
    </tr>
<tr>
      <td>assetsCacheTime</td><td>Cache time</td>
    </tr>
<tr>
      <td>domElements</td><td>Number of DOM elements</td>
    </tr>
<tr>
      <td>domainsPerPage</td><td>Number of domains</td>
    </tr>
    <tr class="success">
      <td colspan="2"><strong>Browser timing</strong></td>
    </tr>
    <tr>
      <td>serverConnectionTime</td><td>The server connnection time</td>
    </tr>
    <tr>
      <td>firstPaintTime</td><td>The time to first paint (if you use Chrome or Internet Explorer)</td>
    </tr>
    <tr>
      <td>domainLookupTime</td><td>The domaion lookup time</td>
    </tr>
    <tr>
      <td>pageLoadTime</td><td>The page load time</td>
    </tr>
    <tr>
      <td>pageDownloadTime</td><td>The page download time</td>
    </tr>
    <tr>
      <td>serverResponseTime</td><td>The server response time</td>
    </tr>
    <tr>
      <td>domContentLoadedTime</td><td>The time to DOM content loaded</td>
    </tr>
    <tr>
      <td>domInteractiveTime</td><td>The time to DOM interactive</td>
    </tr>
    <tr>
      <td>redirectionTime</td><td>The redirect time</td>
    </tr>
  </tbody>
</table>

</div>

<div class="section" id="config-columns">
    <div class="page-header">
 <h2>Columns on pages</h2>
</div>
<p>
You can choose (and <a href="#createcolumns">create</a> your own) data to be showed as columns showed on detailed page summary table. Use the parameter <strong>g</strong> to choose what to show. The table will always show the URL of the page & the rule score, the rest will can you configure.

<pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -g browserScaledImages,requests,domContentLoadedTime,domInteractiveTime -c true</pre>

<p>That will generate a detailed summary page with the following columns:</p>
<p class="text-center">
        <img class="img-responsive img-thumbnail" alt="sitespeed.io columns" src="/img/columns.png"/>
</p>
</p>

You can choose between the following data to be shown as columns:
</p>
<table class="table table-condensed table-striped table-bordered table-small">
  <thead>
    <tr>
      <th>name</th>
      <th>info</th>
    </tr>
  </thead>
  <tbody>
  <tr>
  <td>cssPerPage</td>
  <td>number of CSS files per page</td>
  </tr>     
  <tr>
    <td>fontsPerPage</td>
    <td>number of font files per page</td>
  </tr> 

<tr>
    <td>jsPerPage</td>
    <td>number of javascript files per page</td>
  </tr>
  <tr>
    <td>maxImageWeight</td>
    <td>the largest size of an image</td>
  </tr>
  <tr>
    <td>browserScaledImages</td>
    <td>the number of images scaled by the browser</td>
  </tr>
  <tr><td>cssWeightPerPage</td>
    <td>the amount of CSS per page</td>
  </tr>
  <tr>
    <td>jsSyncInHead</td>
    <td>the number of javascript files loaded synchronous inside of the head tag</td>
  </tr>
  <tr>
    <td>pageWeight</td>
    <td>the weight of the page, including all assets</td>
  </tr>
  <tr>
    <td>criticalPathScore</td>
    <td>the score for the critical path rule</td>
  </tr>
  <tr><td>docWeight</td>
    <td>the weight of the document</td>
  </tr>
  <tr><td>imageWeightPerPage</td>
    <td>the weight of the images per page</td>
  </tr>
  <tr>
    <td>requests</td>
    <td>the number of requests per page</td>
  </tr>
  <tr>
  <td>cssImagesPerPage</td>
  <td>the amount of CSS images per page</td>
</tr>
<tr>
  <td>domainsPerPage</td>
  <td>the number of domains used per page</td>
</tr>
<tr>
  <td>imagesPerPage</td>
  <td>the number of images per page</td>
</tr>
<tr>
  <td>jsWeightPerPage</td>
  <td>the weight of the javascipt files per page</td>
</tr>
<tr>
  <td>requestsWithoutExpires</td>
  <td>the number of requests missing expire date</td>
</tr>
<tr>
  <td>spof</td>
  <td>the number of SPOF per page</td>
</tr>
<tr class="success">
      <td colspan="2"><strong>Browser timing</strong></td>
    </tr>
 <tr>
      <td>serverConnectionTime</td><td>The server connnection time</td>
    </tr>
    <tr>
      <td>firstPaintTime</td><td>The time to first paint (if you use Chrome or Internet Explorer)</td>
    </tr>
    <tr>
      <td>domainLookupTime</td><td>The domain lookup time</td>
    </tr>
    <tr>
      <td>pageLoadTime</td><td>The page load time</td>
    </tr>
    <tr>
      <td>pageDownloadTime</td><td>The page download time</td>
    </tr>
    <tr>
      <td>serverResponseTime</td><td>The server response time</td>
    </tr>
    <tr>
      <td>domContentLoadedTime</td><td>The time to DOM content loaded</td>
    </tr>
    <tr>
      <td>domInteractiveTime</td><td>The time to DOM interactive</td>
    </tr>
    <tr>
      <td>redirectionTime</td><td>The redirect time</td>
    </tr>
  </tbody>
</table>

</div>

<div class="section" id="advanced">
    <div class="page-header">
    <h2>Advanced configuration</h2>
  </div>
 <p>The advanced configuration are things that you probably not need to configure.
 </p>
 </div> 




<div class="section" id="processes">
    <div class="page-header">
 <h2>Changing the number of processes analyzing the site</h2>
</div>
    <p>If you analyze a large web site, the analyze can take some time; then increase the number of processes that analyzes the site (default number of processes is five):</p>
    <pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -p 10</pre>
</div>
<div class="section" id="resultdir">
    <div class="page-header">
 <h2>Change the result directory</h2>
</div>
    <p>The result files will by default be created in a directory named <i>sitespeed-result</i> in the home directory of the sitespeed script. You can change that if you want your files in another place.</p>
    <pre class="bash">$ ./sitespeed.io -u http://yoursite.com  -r /place/the/files/here</pre>
</div>
<div class="section" id="heap">
    <div class="page-header">
 <h2>Heap size for the Java applications</h2>
</div>
    <p>If you are analyzing a very large site, it is possible that you need to increase the memory for the java application, or if you run the test on a machine with low memory, you can change the heap size with the <i>m</i> parameter:</p>
    <pre class="bash">$ ./sitespeed.io -u http://yoursite.com/ -m 512</pre>
</div>
<div class="section" id="proxy">
    <div class="page-header">
 <h2>Run behind a proxy</h2>
</div>
    <p>Behind a proxy you run it like this:</p>
    <pre class="bash">$ ./sitespeed.io -u http://yoursite.com/ -x yourproxy.com:portnumber</pre>
  </div>  



   

<div class="section" id="multiple">
       <div class="page-header">
      <h1>Analyze & compare multiple sites</h1>
    </div>
    <p>From the 2.0 release, you can analyze multiple sites in one go! You can choose which data you want to compare between the sites (the ones in the image are the default ones). A result page will look like this:</p>

  <p class="text-center">
        <img src="/img/multiple-sites-2.0.jpg" alt="sitespeed.io screenshot page" class="img-thumbnail"/>
      </p>

      <p>
  The script needs a plain text file with one URL on each row. By default, the script will look for a file named <em>urls.txt</em> (you can configure another name if you want). The view will be a table with each site on one row, where you choose which data from the <em>summary.xml</em> file you want to display (you can choose what kind of metric you want; like number of requests per page, rule score or the time for DOMContent loaded). And you also choose how you want it: median, average, min, max and different percentiles.</p>

  <p>For each URL, a regular analyze will be done, so you can see all the pages & data that has been analyzed.</p>


<h3>Configuration</h3>
You have the options to feed the script:
  <pre>
OPTIONS:
 -h      Help
 -r      The result base directory, default is sitespeed-result/sites [optional]
 -e      The columns to display in the result table [optional]
 -i      The path to a plain text file with one url on each row. Default name is urls.txt [optional]
 </pre>
  <p>All other parameters will then be feed to the original sitespeed.io script, meaning you can configure that one exactly as you are used to. So if you want to also collect browser timings data, you can do that like this:
  </p>
  <pre class="bash">./sitespeed-sites.io -c true
  </pre>


<h3>Choose values to be displayed</h3>
<p>By default, the following median values will be showed:</p>
  <ul>
  <li>median-ruleScore</li>
  <li>median-criticalPathScore</li>
  <li>median-requests</li>
  <li>median-imageWeightPerPage</li>
  <li>median-pageWeight</li>
  <li>median-requestsWithoutExpires</li>
  <li>median-assetsCacheTime</li>
  <li>median-domainsPerPage</li>
  </ul>

  And if you collect browser timings these two are also added:
  <ul>
  <li>median-serverResponseTime</li>
  <li>median-domContentLoadedTime</li>
</ul>

  <p>The naming convention is what kind of measure (median/max etc) followed by the actual metric</p>

 <p>Here's an example focus on comparing image data between sites:</p>
 <pre class="bash">./sitespeed-sites.io -e median-imageWeightPerPage,max-imageWeightPerPage,median-imageWeight,max-imageWeight,median-imagesPerPage,median-cssImagesPerPage,median-browserScaledImages,max-browserScaledImages</pre>

  <div class="note note-info">When doing these kind of text, choosing maximum number of pages to test for a site is really good, use the <em>j</em> parameter!</div>

</div>

<div class="section" id="browsertime">
    <div class="page-header">
 <h2>Collect Browser timings</h2>
</div>
  <p>You can collect Browser timings in sitespeed.io, using the Open Source project <strong>Browser Time</strong> that collects metrics using the data in the Navigation Timing API (and also some other data/metrics). You can choose which browser to use (it must of course support the Navigation Timing API) and how many runs you want per page. It will then do a summary for each metric with the minimum, maximum, average, median and the 60, 70, 80 & 90 percentile.</p>


  Out of the box, the following timings is collected:
  <div class="table-responsive">
 <table class="table table-condensed table-striped table-bordered table-small">
  <thead>
    <tr>
      <th>name</th>
      <th>definition (using Navigation Timing API)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>serverConnectionTime</td><td>connectEnd - connectStart</td>
    </tr>

<tr>
      <td>domainLookupTime</td><td>domainLookupEnd - domainLookupStart</td>
    </tr>
<tr>
      <td>pageLoadTime</td><td>loadEventStart - navigationStart</td> 
    </tr>
<tr>
      <td>pageDownloadTime</td><td>responseEnd - responseStart </td>
    </tr>
<tr>
      <td>serverResponseTime</td><td>responseStart - requestStart</td>
    </tr>
<tr>
      <td>domContentLoadedTime</td><td>domContentLoadedEventStart - navigationStart</td>
    </tr>
<tr>
      <td>domInteractiveTime</td><td>domInteractive - navigationStart</td>
    </tr>
<tr>
      <td>redirectionTime</td><td>fetchStart - navigationStart</td>
    </tr>
  </tbody>
</table>
</div>
  <p>By default <em>FireFox</em> is used but you can choose to use <em>Chrome</em> or <em>Internet Explorer</em> (if you use these, you will automatically get the first paint value reported by the browser!).
</p>
 
 <p> As an extra bonus, it also fetches your user marks that you have! That is really cool, because you can setup your own marks. There will be more documentation later on how to use this!
</p>
<div class="note note-warning">Browser Time is still in an early version, so there can be some stability issues that will be taken care of in future releases.
</div>
<div class="note note-info">Read <a href="http://blog.patrickmeenan.com/2013/07/measuring-performance-of-user-experience.html" target="_blank">this</a> blog post by Patrick Meenan on how to instrumenting your pages</div>

  
   

   </div>


<div class="section" id="summaryxml">
       <div class="page-header">
      <h2>The summary.xml file</h2>
    </div>
    <p>The summary.xml file is the heart of you analyze, because it collects all data. Each metric will look like this (where the first tag is the metric name):
      <pre>
&lt;ruleScore friendlyName="Rule score" type="" unit="" decimals="1"&gt;
  &lt;avg&gt;99.0&lt;/avg&gt;
  &lt;median&gt;99.0&lt;/median&gt;
  &lt;max&gt;99.0&lt;/max&gt;
  &lt;min&gt;99.0&lt;/min&gt;
  &lt;standardDev&gt;0.0&lt;/standardDev&gt;
  &lt;variance&gt;0.0&lt;/variance&gt;
  &lt;percentile10&gt;99.0&lt;/percentile10&gt;
  &lt;percentile60&gt;99.0&lt;/percentile60&gt;
  &lt;percentile70&gt;99.0&lt;/percentile70&gt;
  &lt;percentile80&gt;99.0&lt;/percentile80&gt;
  &lt;percentile90&gt;99.0&lt;/percentile90&gt;
  &lt;percentile95&gt;99.0&lt;/percentile95&gt;
  &lt;values&gt;1&lt;/values&gt;
&lt;/ruleScore&gt;
  </pre>

  <p>You can see a full summary.xml file <a href="summary-2.0.xml" target="_blank">here</a>.
  <p>When testing many pages, this is a really pleasent view! Today is used for the summary page, detailed summary and in Jenkins to create charts.</p>

</div>


<div class="section" id="harfiles">
       <div class="page-header">
      <h2>HAR-files</h2>
    </div>
    <p>The HAR-files are created for each page (using PhantomJS) and located in <em>data/har/</em>. You cannot see them in the result page (that will be implemented in later releases), but you can use them and view them yourself in the <a href="http://www.softwareishard.com/har/viewer/" target="_blank">HARviewer</a>.</p>

    <div class="note note-warning">The HAR files from PhantomJS only displays one timing for each asset (missing specifying DNS lookup and other timings) and is not containing any loading metrics.</div>


  </div>


<div class="section" id="continuousintegration">
       <div class="page-header">
      <h2>Continuous integration</h2>
    </div>
    <p>Use sitespeed.io to keep track of what is happening with your site and make sure you know that you don't break the rules before it is release!</p>

 </div>   
<div class="section">
 <div class="page-header">
      <h2 id="junit">Generating the JUnit XML for continuous integration</h2>
    </div>
       <p>Sitespeed can output <em>junit.xml</em> that works perfect with your continuous integration tool. Jenkins, Bamboo and others support it out of the box.
        To generate the xml, you need to run the script <strong>sitespeed-junit.io</strong> after the normal script (it will take the latest created sitespeed analyze and parse it to the junit.xml).
        The JUnit script takes the following parameters:</p>
        <pre>
OPTIONS:
-h      Help
-o      The output dir
-r      The result base directory, default is sitespeed-result [optional]
-l      The page score limit. Below this page score it will be a failure. Default is 90. [optional]
-a      The average score limit for all tested pages, below this score it will be a failure. Default is 90. [optional]       
-s      Skip these tests. A comma separated list of the key name of the tests, for example "ycsstop,yjsbottom" [optional]
        </pre> 
   <p><em>Note:</em> the key name used when skip the tests, is viewed in the the Jenkins result, check the title for each page, the key is the name before the colon, for example <em>ynumreq: Make fewer HTTP requests</em> where <strong>ynumreq</strong> is the key.
  </p>

</div>


<div class="section">
      <h2 id="jenkins">Jenkins integration</h2>
     <a href="http://jenkins-ci.org/" target="_blank">Jenkins</a> is a great open source continuous integration server.
   <p>
    To get sitespeed.io up and running, you need to make sure that the user in <strong>Jenkins</strong> that runs the job, have <a>PhantomJs</a> in the path and
    have read/write access to the directory where you have sitespeed. When you have that, you are ready to set it up.
  </p>
  <p>
    In Jenkins, add a new <em>Execute shell</em> and add the two script on one line each. The first one is the standard script, and the second one will create the junit.xml, make sure to pipe the output to a file, so Jenkins can find it.</p>
        <pre>
/Users/peter/tmp/sitespeed.io -u http://yoursite.com
/Users/peter/tmp/sitespeed-junit.io -o /Users/Shared/Jenkins/Home/workspace/sitespeed.io/
        </pre>
        <p>Then add a <em>Post-build Action</em> that will publish the JUnit test result report, and choose the output file from the script. In Jenkins, this is how it looks:
      </p>
       <p class="text-center">
        <a href="jenkins-sitespeed-config.png"><img src="jenkins-sitespeed-config.png" alt="Configuration Sitespeed.io for Jenkins" class="img-thumbnail"/></a>
      </p>

      <p class="text-center">
          
        <a href="jenkins-junit-setup.png"><img src="jenkins-junit-setup.png" alt="Configuration JUnit.xml file" class="img-thumbnail"/></a>
      </p>

      <p>Each sitespeed test, is a JUnit testcase, each page tested is a test suite and the whole test bundled as test suites. The cool thing is that you will get a good overview: you can see the failures for all pages, and you can also drill down the result page by page.

      </p>
       <p class="text-center">
       <a href="jenkins-test-all-pages.jpg"><img src="jenkins-test-all-pages.jpg" alt="All the tested pages" class="img-thumbnail"/></a>
      </p>

      <p>
        And for a specific page:</p>
       <p class="text-center">
        <a href="jenkins-tests-for-one-page-full.jpg"><img src="jenkins-tests-for-one-page.jpg" alt="One full test" class="img-thumbnail"/></a>
      </p>

      <p>Running the sitespeed JUnit script, will also copy the <em>summary.xml</em> file to the output directory. Using the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Plot+Plugin" target="_blank">Jenkins plot plugin</a> will then create graphs between builds of the metrics you choose (and you can choose between all that you have in the <a href="summary-2.0.xml">summary.xml</a> file. For every metric you want, add the xpath to the value you want to fetch. If you want to fetch the median value of the page weight, add the XPath <strong>//site/metrics/pageweight/median</strong>.</p>
<p class="text-center">
   <a href="jenkins-plot-setup.png"><img src="jenkins-plot-setup.png" alt="Setup the plot plugin" class="img-thumbnail"/></a>
</p>

<p>And the graphs:</p>
<p class="text-center">
<a href="plot-graph-example.png"><img src="plot-graph-example.png" alt="The graph" class="img-thumbnail"/></a>
</p>

<div class="note note-warning">Sitespeed.io with Jenkins don't have support to add limit and break test for the time measurements done by Browser Time, that will happen in the upcoming 2.1 release.</div>

  </div>

<div class="section">

      <h2 id="travis">Travis integration</h2>
      <p>
      <a href="https://travis-ci.org/" target="_blank">Travis</a> doesn't have a built in support for JUnit XML right now (read this  
      <a href="https://github.com/travis-ci/travis-ci/issues/239" target="_blank">issue</a> about the plan for supporting it).
      But you can of course use it and break the build if you have failures.
      </p>
      
      <p>Setup your <strong>.travis.yml</strong> file (before you run the <em>before_script</em> you need to start your server (that is not included), in this example the server runs on http://127.0.0.1:8080/.
      <pre>
before_install:
- sudo apt-get update
- sudo apt-get install xsltproc
        
before_script:
- "./sitespeed.io/sitespeed.io -u http://127.0.0.1:8080/"
- "./sitespeed.io/sitespeed-junit.io -o ../../../../"

script: ./verify-junit.sh sitespeed.io-junit.xml 
</pre>

The <strong>verify-junit.sh</strong> script is a simple script that fails if it find the failure tag (but of course you can do more cool things if you want, 
this is just a super simple example):
<pre>
#! /bin/bash
JUNIT_XML=$1
 if grep -c "&lt;/failure&gt;" "$JUNIT_XML" > 0; 
 then
   FAILURES=$(grep -o "&lt;/failure"&gt;" $JUNIT_XML | wc -l)
   echo "We have a $FAILURES failure(s)"
   cat $JUNIT_XML
   exit 1;
 else
  echo 'No failures from sitespeed.io'
 fi   
</pre>      
      
      </div>


<!--
<div class="section">
  <div class="row-fluid">
    <div class="span12">
      <div class="page-header">
      <h2 id="csv">Export as CSV</h2>
    </div>
    <p>You can export the data showed on the <a href="pages">detailed site report</a> as a plain CSV file. The CSV file is a comma separated list, tested in Excel & Open Office. To generate the CSV file, use the 
      <a href="imgandcsv"></a>

      #pages Detailed site report
    </p>

    </div>
</div>
</div>
-->
<div class="section">

      <div class="page-header">
      <h2 id="developers">Developers</h2>
    </div>
    <p style="word-wrap: break-word;">
    You can fork the project at <a href="https://github.com/soulgalore/sitespeed.io" target="_blank">https://github.com/soulgalore/sitespeed.io</a> and create 
    your own version or contribute to the existing one. There are two branches: <strong>master</strong> is the latest release. No development happens in master. The other branch is <strong>versionnumber-wip</strong>, meaning <strong>2.0-wip</strong> that are the branch that is work in progress, and the next coming release.  
    </p>

    </div>



<div class="section">

      <div class="page-header">
      <h2 id="dependencies" style="word-wrap: break-word;">Dependencies</h2>
    </div>
      <p>
        Here are the dependencies for running sitespeed.io:
      </p>
      <dl class="dl-horizontal">
        <dt>Linux/Unix</dt>
        <dd>Linux/Unix or a Linux-like environment for Windows like Git Bash.</dd>

        <dt>PhantomJS</dt>
      <dd><a href="http://phantomjs.org/" target="_blank">PhantomJS</a> is a headless WebKit with JavaScript API. It is really cool product where you can do browser things without a browser. You need to have it installed to be able to run sitespeed.io.</dd>

      <dt>Java 1.6</dt>
      <dd>You need to have Java 1.6 (or higher) installed because many components used are written in Java.</dd>
    
      <dt>cURL</dt>
        <dd>cURL is used to fetch the time to first byte and the size of a gzipped page.</dd>
        <dt>xsltproc</dt>
        <dd>xsltproc is used to match the JUnit XSL file with the XML result from the analyze to create the JUNit XML file</dd>

        </dl>
</div>

<div class="section">
      <div class="page-header">
      <h2 id="components">Components</h2>
</div>

      <p>The following components are used by sitespeed.io:</p>
      <dl class="dl-horizontal">
         <dt>YSlow</dt> 
      <dd>Sitespeed.io uses the rule engine of <a href="http://yslow.org" target="_blank">YSlow</a>, because it is great! YSlow was originally developed by Yahoo and now maintained by <strong>Marcel Duran</strong>, a rule engine & browser plugin created to test your web page against <a href="http://yslow.org/#web_performance_best_practices_and_rules" target="_blank">best practices rules</a>. The version used is the <a href="https://github.com/marcelduran/yslow/wiki/PhantomJS" target="_blank">YSlow/PhantomJs</a> version. Sitespeed uses it own ruleset of best practice performance rules, and the code can be found  <a href="https://github.com/soulgalore/yslow/blob/master/src/common/rulesets/ruleset_sitespeed.js" target="_blank">here</a>.</dd>
      <dt>Bootstrap</dt>
      <dd><a href="http://getbootstrap.com/" target="_blank">Bootstrap</a> is a front end framework to create nice looking HTML, all the front end of the result pages produced by sitespeed are built with Bootstrap.</dd>
      <dt>HTMLCompressor</dt>
      <dd>The <a href="http://code.google.com/p/htmlcompressor/" target="_blank">HTMLCompressor</a> Compress/minifies the HTML result pages, to do them as clean & small as possible.</dd>
      <dt>Velocity</dt>
      <dd><a href="http://velocity.apache.org/" target="_blank">Apache Velocity</a> is an (old but great  Java template engine, the reason it is used, it because gives the possibility of getting hold of whatever Java library that is needed to do things in the front end. The statistics calculated on the summary page (median & averages) are using the Apache Commons <a href="http://commons.apache.org/math/" target="_blank">Math library</a>. </dd>
      <dt>Crawler</dt>
      <dd>This is a simple  <a href="https://github.com/soulgalore/crawler" target="_blank">Java crawler</a> that output all links within a domain to a file, it can follow a specific path or make sure urls containing X not will be fetched. In the backend it uses Java:s best HTTP framework: <a href="http://hc.apache.org/" target="_blank">HttpComponents</a> that makes sure it can pretty sure do whatever you want.</dd>
      <dt>XMLToVelocity</dt>
      <dd><a href="https://github.com/soulgalore/xml-velocity" target="_blank">XMLToVelocity</a> is a small Java component that parses a XML-file with a Velocity template.</dd>
      <dt>Stupid Table Plugin</dt>
      <dd><a href="https://github.com/joequery/Stupid-Table-Plugin" target="_blank">Stupid Table Plugin</a> is a really small table column sorter (yes two different is used today, one needs to go away).</dd>
       <dt>BrowserTime</dt>
        <dd><a href="https://github.com/tobli/browsertime" target="_blank">BrowserTime</a> collects browser timings using the Navigation Timing API.</dd>

      </dl>

</div>


<div class="section">
      <div class="page-header">
      <h2 id="feature" style="word-wrap: break-word;">Create a new feature/improvement request</h2>
    </div>
    <p>
      If you have ideas of how sitespeed.io can be improved or if you have any features that you think is missing, please add it to the <a href="https://github.com/soulgalore/sitespeed.io/issues?labels=&milestone=&page=1&state=open" target="_blank">issue list</a>.
    </p>

    </div>


<div class="section">
      <div class="page-header">
      <h2 id="bug">Report a bug</h2>
    </div>
    <p style="word-wrap: break-word;">
     If you find a bug, go through the current known bug list <a href="https://github.com/soulgalore/sitespeed.io/issues?labels=bug&state=open" target="_blank">https://github.com/soulgalore/sitespeed.io/issues?labels=bug&state=open</a>. If it doesn't exist there, please add it!
    </p>

    </div>

<div class="section">
      <div class="page-header">
      <h2 id="configurerulelimit">Configure rule limits</h2>
    </div>
    <p>There are two different rules & limits. One is the rules system implemented in the YSlow engine, the other is the rules that chooses the colors on the summary page (green/yellow/red). You can configure & change these with a property file, located in the <pre>dependencies</pre> directory. There are actually two files, one for desktop & one for mobile rules:</p>
      <pre>
dependencies/rules-desktop.properties
dependencies/rules-mobile.properties
      </pre>
      <p>
        The rules are defined with keys & values. The keys are the rule box name, the same name you use to decide which boxes that should be shown. The values are three values separated by a <strong>;</strong> character. The direction, the limit to get green and the limit to get yellow.
    </p>
    <pre>
# The sitesped score
ruleScore=GREATER_THAN;89.99;80
    </pre>
    <p>You need to have a rule score greater than 89.99 to get green, and greater than 80 to get yellow.
    </p>

    <pre>
# The number of css images
cssImagesPerPage=LESS_THAN;2;5
    </pre>
<p>You need to have less than two CSS images per page to get green and you need less than five to get yellow.
</p>    
</div>


<div class="section">
      <div class="page-header">
      <h2 id="createbox">Create your own box on the summary page</h2>
      <p>
      You create your own box by adding your own metrics to the summary.xml file. For Browser metrics, it will be added automatically (yes!), for rule metrics you need to add them yourself:</p>
      <ol>
        <li>Create a file (or preferable a symbolic link) <pre>report/velocity/logic/custom/site.summary.xml.logic.vm</pre> file. Do that so you can keep the changes betweeb releases.</li>
        <li>Create your own statistics object (<em>com.soulgalore.velocity.NamedDescriptiveStatistics</em>):
          <pre>#set($statsCriticalPath = $stats.newInstance("criticalPathScore","Critical Rendering Path Score","","","",1))</pre>
        </li>
        <li>Add the stats object to the statistics holder, a simple Map that holds all objects
          <pre>#set($hide = $allStats.add($statsCriticalPath))</pre>
        </li>

        <li>Now loop through the YSlow/sitespeed.io xml, and add the data you want. In this example we take the rule score for the critical path rule and adds it to the statistics 
          <pre>
#foreach ($results in $document.getRootElement().getChildren())
  #if($!{results.getChild("g").getChild("criticalpath").getChild("score")})
    $statsCriticalPath.addValue($math.toInteger($results.getChild("g").getChild("criticalpath").getChild("score").getValue()))
  #end
#end
          </pre>
        </li>
        <li>Voila, now the stats will end up in the summary.xml file and you can add it to your views with the parameters to the script.</li>
      </ol>

    </div>
 </div>   

 <div class="section">
      <div class="page-header">
      <h2 id="createpagecolum">Create your column for the pages table</h2>
      <p>It is possible to add your own columns with whatever data you want in the pages table. If you want to add your own Browser Time metrics, it is easy, just you just have to name your metric name end with <em>time</em> then it will automatically be possible to view. Say that you on your page has added your own measurement called <em>atfTime</em>, then you just add that as a column like this</p>
      <pre class="bash">./sitespeed.io -u http://www.peterhedenskog.com -c true -g aftTime</pre>
      <p>In the real world you probably want to show something more ...</p>
      <p>Adding a column for rules needs a little more, you need to create a file for the column headers and a file for displaying the actual column data. For example, you have a rule in your 
        ruleset that checks XXX, name the rule example. </p>
      <ol>
        <li>Create a symbolic link to 
          <pre>report/velocity/inc/pages/column-headers/custom/example.vm</pre>
        </li>
        <li>Also create a symbolic link to <pre>report/velocity/inc/pages/columns/custom/example.vm</pre>
        </li>
      </ol>
    </div>
 </div>   

<div class="section" id="addrule">
      <div class="page-header">
      <h2>Add your own rules</h2>
    </div>
    <p style="word-wrap: break-word;">
      Sitspeed uses <a href="http://yslow.org/" target="_blank">YSlow</a> as the engine for creating and managing the rules that decides how good the web page is optimized for performance.  <a href="https://twitter.com/stoyanstefanov" target="_blank">Stoyan Stefanov</a> has written three good blog posts of how you develop and write rules for YSlow:
    </p>
      <ul>
        <li><a href="http://www.phpied.com/yslow-development-getting-started/" target="_blank">Getting started</a></li>
        <li><a href="http://www.phpied.com/yslow-development-setup/" target="_blank">Setup</a></li>
        <li><a href="http://www.phpied.com/yslow-development-custom-rulesets/" target="_blank">Custom ruleset</a></li>
      </ul>

      <p>
      To do it for sitespeed, this is what you need:
      </p>
      <ol>
        <li><p>Clone the project: 
          <pre>git clone git@github.com:soulgalore/yslow.git</pre>
        </p>
        </li>
        <li><p style="word-wrap: break-word;">There are two files that you need to change, first the rule file, where you actually add your own rule:
          <a href="https://github.com/soulgalore/yslow/blob/master/src/common/rulesets/ruleset_sitespeed.js" target="_blank">https://github.com/soulgalore/yslow/blob/master/src/common/rulesets/ruleset_sitespeed.js</a>. </p>

          <p>You need to do two changes: Add your rule <i>YSLOW.registerRule(...)</i> and register your rule to the ruleset <i>YSLOW.registerRuleset(...)</i></p>
          <p>In this example, I will add a rule called <b>cssprint</b> that will check for css files used only for printing the page:</p>
<pre class="prettyprint">
YSLOW.registerRule({
id: 'cssprint',
name: 'Do not load print stylesheets, use @media type print instead',
info: 'Loading a specific stylesheet for printing slows down the page, ' +
      'even though it is not used',
category: ['css'],
config: {points: 20},
url: 'http://sitespeed.io/rules/#cssprint',

lint: function (doc, cset, config) {
var i, media, score,url,
      offenders = [],
      hash = {},
      comps = cset.getComponentsByType('css'),
      links = doc.getElementsByTagName('link');

       for (i = 0, len = links.length; i < len; i += 1) {

        if (links[i].media === 'print') {
          url = links[i].href;           
          hash[url] = 1;
        }
      }

   for (var i = 0; i < comps.length; i++) {
    if (hash[comps[i].url]) {
      offenders.push(comps[i]);
    }
  }
    score = 100 - offenders.length * parseInt(config.points, 20);
    
    return {
    score: score,
    message: (offenders.length > 0) ? YSLOW.util.plural(
        'There %are% %num% print css files included on the page, that should be @media query instead',
        offenders.length
    ) : '',
    components: offenders
  };
 }
});  
</pre>

<p>When you have written your rule, register it to the ruleset and give it a proper weight (the lines with <b>cssprint</b> are the new ones, the rest exists already):</p>

<pre>
YSLOW.registerRuleset({ 
  id: 'sitespeed.io-X.Y',
  name: 'Sitespeed.io rules vX.Y',
  rules: {
  ...
 cssprint: {},
 ...
 weights: {
 ...
 cssprint: 3,
 ...
 </pre>

        </li>

        <li><p style="word-wrap: break-word;">The next step is adding the documentation for the rule, you do that in the file: <a href="https://github.com/soulgalore/yslow/blob/master/src/common/doc.js" target="_blank">https://github.com/soulgalore/yslow/blob/master/src/common/doc.js</a>.</p> <p>You add one row where you put in the rule info:
          <pre>YSLOW.doc.addRuleInfo('rulename','title','description')</pre>

          For the <b>cssprint</b> rule, it looks like this:
          <pre>YSLOW.doc.addRuleInfo('cssprint','Avoid loading specific css for print','Loading a specific stylesheet for print, can block rendering in your browser (depending on browser version) and will for almost all browsers, block the onload event to fire (even though the print stylesheet is not even used!).');
          </pre>

         It is used when you run sitespeed to create the rule definition HTML file that is put into the results, so you always can backtrack which rules you use. </p>
        </li>
        <li>Create the new YSlow javascript file: <pre>make phantomjs</pre></li>
        <li>Test that it works on one url (standing in root for YSlow): <pre>phantomjs build/phantomjs/yslow.js d -r sitespeed.io-2.0-desktop -f xml http://yoururl.com</pre></li>
        <li>Move the newly created rulefile into your dependencies directory for sitespeed, on my local I do it this way:
          <pre>cp build/phantomjs/yslow.js ../sitespeed.io/dependencies/yslow-3.1.5-sitespeed.js</pre>
         </li>
         <li>Run sitespeed: <pre>./sitespeed.io -u http://yoururl.com</pre></li>
       </ol>
          

    </div>
</div>

        


