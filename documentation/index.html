---
layout: default
title: Documentation - Sitespeed.io
description: Here's the documentation of sitespeed.io, the workflow, how you run it and how you extend it as a developer.
keywords: documentation, workflow, sitespeed.io, jenkins, travis
author: Peter Hedenskog
nav: documentation
image: http://sitespeed.io/img/sitespeed-twitter.gif
twitterdescription: Add your own rules to sitespeed.io is easy, because of the use of YSlow as the rule engine. Read here how you do it!
---
 <div class="row">
    <div class="col-lg-12">
      <div class="page-header">
  <h1>
    Documentation
  </h1>
</div>  
<ol id="toc">
  <li class="toc"><a href="#introduction">Introduction</a></li>
  <li class="toc"><a href="#installation">Download and installation</a></li>
  
  <li class="toc"><a href="#analyzeasite">Analyze a site</a></li>
  <ul>
    <li class="toc"><a href="#summarypage">Configuration</a></li>
    <ul>
      <li class="toc"><a href="#summarypage">Basic configuration</a></li>
      <li class="toc"><a href="#summarypage">Boxes on summary page</a></li>
      <li class="toc"><a href="#summarypage">Columns on pages</a></li>
      <li class="toc"><a href="#summarypage">Output CSV</a></li>
      <li class="toc"><a href="#summarypage">Take screenshots</a></li>
      <li class="toc"><a href="#summarypage">Behind a proxy</a></li>
      <li class="toc"><a href="#summarypage">Analyze as mobile</a></li>
      <li class="toc"><a href="#summarypage">Limit pages to test</a></li>
      <li class="toc"><a href="#summarypage">Full configuration</a></li>
    </ul>
   </ul>
   <li class="toc"><a href="#run">Analyze & compare multiple sites</a></li>
  <ul>
    <li class="toc"><a href="#summarypage">Configuration</a></li>
      <ul>
        <li class="toc"><a href="#summarypage">Basic configuration</a></li>
        <li class="toc"><a href="#summarypage">Choose columns for report</a></li>
      </ul>
   </ul>
   <li class="toc"><a href="#run">Continus integration</a></li>
  <ul>
     <li class="toc"><a href="#junit">Generating the JUnit XML for continous integration</a></li>
      <li class="toc"><a href="#jenkins">Jenkins integration</a></li>
  <li class="toc"><a href="#travis">Travis integration</a></li>
</ul>
 <li class="toc"><a href="#developers">Developers</a></li>
  <ul>
<li  class="toc"><a href="#workflow">The workflow</a></li>
  <li class="toc"><a href="#dependencies">Dependencies</a></li>
     <li class="toc"><a href="#components">Components</a></li>
     <li class="toc"><a href="#feature">Create a new feature request</a></li>
     <li class="toc"><a href="#bug">Report a bug</a></li>
     <li class="toc"><a href="#addrule">Add your own rules</a></li>
   </ul>
 </ol>


 <div class="section" id="introduction">
  <div class="page-header">
      <h2>Introduction</h2>
    </div>
    <p>Sitespeed.io is an open source tool that will check your site against web performance best practice rules and the <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html" target="_blank">Navigation Timing API</a> to collect metrics. It will create XML & HTML output of the result.
    </p>
 </div>


<div class="section" id="installation">

      <div class="page-header">
      <h2 >Download and installation</h2>
    </div>

      {% include installation.html %}
      
      <p>If you are using Windows, you need to install <a href="https://code.google.com/p/msysgit/downloads/list?q=label:Featured" target="_blank">Git Bash</a>.</p>

    </div>





<div class="section" id="analyzeasite">
    <div class="page-header">
    <h2>Analyze a site</h2>
  </div>

<p>You can analyze a site either by crawling or feed sitespeed.io with the url:s you want to analyze.
</p>
<h3>Analyze by crawling</h3>
<p>The crawler will need a start URL (the parameter <strong>u</strong>, from where it will start the crawl. It will fetch all links within the same domain as the URL that you provide. You can then choose how deep you want to crawl with the <strong>i</strong> parameter. Zero will fetch only that 
  URL that you provide. One will fetch all links on that page and analyze these, two will go one level deeper and so on. If you want to analyze a site and the links with a depth of four, you do like this:
</p>
<code class="bash">$ ./sitespeed.io -u http://www.yoursite.com -d 4</code>

<div class="note note-info"><strong>Note:</strong> Remember that you can start your crawl deep into your path structure like <strong>http://yoursite.com/my/path</strong>. It is also good practice to use the crawler in you CI-tool, to make sure you fetch new URL:s that are created!</div>

<h3>Analyze by file</h3>
<p>Instead of giving a start URL for the crawl, you can supply a plain text file with one URL on each row. Then each of these URL will be analyzed, no more or no less. A file like this will do:</p>

<pre>
http://www.yoursite.com/path/
http://www.yoursite.com/my/really/important/page/
http://www.yoursite.com/where/we/are/
</pre>
<p>Then you feed the file to the script:</p>
<code class="bash">$ ./sitespeed.io -f myurls.txt</code>
<div class="note note-info"><strong>Note:</strong> This is good for testing and keep track of your site in production and you have a LARGE site with thousend/million pages and a couple of them are more important than the rest. </div>

<h3>Include/exclude URL:s when crawling</h3>
<p>You want to make sure that parts of your site isn't included in your analyze, then you can add the parameter <strong>s</strong> and a keyword. Everry URL with that keyword will not be included.</p>
 <code class="bash">$ ./sitespeed.io -u http://yoursite.com  -s /monkey/</code>
<p>You can also do it the other way around, with the <strong>c</strong> and a keyword. In this case, the analyze will only include URL:s with the keyword.
<code class="bash">$ ./sitespeed.io -u http://yoursite.com  -c /the/path/</code>

<h3>Vieport/user agent & mobile</h3>
You can set the viewport.

By default the viewport is ... with the folowing user agent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.71 Safari/537.36" 
(that is Chrome on MacOSX).

You can set the user agent to <strong>iphone5</strong> or <strong>ipad</strong> That will automatically set the viewport to .... 

<h3>Take screenshots</h3>
You can get screenshots of every page that you analyze. These will end up on a screenshot page that is in the navigation, where you van look at them all. The screenshots will be taken for the chosen viewport.

<h3>Output CSV</h3>
<p></p>


<h3>Full configuration</h3>
<p>You have the following options running sitespeed.io:</p>
<pre>
usage: ./sitespeed.io options

OPTIONS:
   -h      Help
   -u      The start URL of the crawl: http[s]://host[:port][/path/]. Use this or use the -f file option.
   -f      The path to a plain text file with one URL on each row.
   -d      The crawl depth, default is 1 (one page and all links pointing to the same domain on that page) [optional]
   -c      Crawl URLs only URLs that contains this keyword in the path [optional]
   -s      Skip URLs that contains this keyword in the path [optional]
   -p      The number of processes that will analyze pages, default is 5 [optional]
   -m      The memory heap size for the Java applications, default is 1024 Mb [optional]
   -n      Give your test a name, it will be added to all HTML pages [optional]
   -o      The output format, always output as HTML and you can also output a CSV file for the detailed site summary page  (csv) [optional]
   -r      The result base directory, default is sitespeed-result [optional]
   -z      Create a tar zip file of the result files, default is false [optional]
   -x      The proxy host & protocol: proxy.soulgalore.com:80 [optional] 
   -t      The proxy type, default is http [optional]
   -a      The full User Agent string, default is Chrome for MacOSX. You can also set the value as iphone or ipad (will automagically change the viewport) [optional]
   -v      The view port, the page viewport size WidthxHeight, like 400x300, default is 1280x800 [optional] 
   -y      The compiled YSlow file, default is dependencies/yslow-3.1.5-sitespeed.js [optional]
   -l      Which ruleset to use, default is the latest sitespeed.io version for desktop [optional]
   -g      The columns showed on detailes page summary table, see http://sitespeed.io/documentation/#pagescolumns for more info [optional] 
   -b      The boxes showed on site summary page, see http://sitespeed.io/documentation/#sitesummaryboxes for more info [optional]
   -j      The max number of pages to test [optional]   
   -k      Take screenshots for each page (using the configured view port). Default is false. (true|false) [optional]    
</pre>

    
  
    <h3>Changing the number of processes analyzing the site</h3>
    <p>If you analyze a large web site, the analyze can take some time; then increase the number of processes that analyzes the site (default number of processes is five):</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com  -p 10</code>
    
    <h3 id="imgandcsv">Output as images</h3>
    <p>You can also output the result of the analyze as png:s (the html converted to png:s) or the pages information as a csv file:</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com  -o img</code>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com  -o csv</code>

    <h3 id="changeresult">Change the result directory</h3>
    <p>The result files will by default be created in a directory named <i>sitespeed-result</i> in the home directory of the sitespeed script. You can change that if you want your files in another place.</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com  -r /place/the/files/here</code>
    
    <h3 id="tar">Tar zip all the result files</h3>
    <p>If you want all the result files tar zipped into one file:</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com/ -z true</code>
    
    <h3 id="heap">Heap size for the Java applications</h3>
    <p>If you are analyzing a very large site, it is possible that you need to increase the memory for the java application, or if you run the test on a machine with low memory, you can change the heap size with the <i>m</i> parameter:</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com/ -m 512</code>

    <h3 id="proxy">Run behind a proxy</h3>
    <p>Behind a proxy you run it like this:</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com/ -x yourproxy.com:portnumber</code>

    <h3 id="useragent">Set the user agent and view port</h3>
    <p>Test as Chrome with a large screen:</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com/ -a Mozilla/5.0 -v 2560x1440</code>

    <h3 id="name">Set a name of your test</h3>
    <p>You can give your test run a name, that will be showed on all the pages</p>
    <code class="bash">$ ./sitespeed.io -u http://yoursite.com/ -n "Swedens top 100 sites"</code>

    <h3 id="pagecolumns">Choose which columns to show in the table in detailed summary page</h3>
    <p>
      You can choose which columns you want to see in the table in the detailed summary page, by adding a comma separated list of the column names, showed in the table below:
    </p>

      <table class="table table-condensed table-striped table-bordered">
        <thead>
          <tr>
            <th>Name</th>
            <th>Info</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>url</td>
            <td>The URL</td>
          </tr>
          <tr>
            <td>js</td>
            <td>The number of javascripts</td>
          </tr>
          <tr>
            <td>css</td>
            <td>The number of CSS</td>
          </tr>
          <tr>
            <td>img</td>
            <td>The number of images</td>
          </tr>
          <tr>
            <td>cssimg</td>
            <td>The number of CSS images</td>
          </tr>
          <tr>
            <td>font</td>
            <td>The number of fonts</td>
          </tr>
          <tr>
            <td>requests</td>
            <td>The total number of requests</td>
          </tr>
          <tr>
            <td>requestswithoutexpires</td>
            <td>The number of requests without an cache expire</td>
          </tr>
          <tr>
            <td>docsize</td>
            <td>The document size</td>
          </tr>
          <tr>
            <td>pagesize</td>
            <td>The total page size</td>
          </tr>
          <tr>
            <td>criticalpath</td>
            <td>The score for the critical rendering path</td>
          </tr>
          <tr>
            <td>loadtime</td>
            <td>The load time</td>
          </tr>
          <tr>
            <td>spof</td>
            <td>The single point of failure score</td>
          </tr>
          <tr>
            <td>syncjs</td>
            <td>The amount of JS loaded sync inside head</td>
          </tr>
          <tr>
            <td>ttfb</td>
            <td>The time to first byte</td>
          </tr>
          <tr>
            <td>domains</td>
            <td>The number of domains</td>
          </tr>
          <tr>
            <td>kbps</td>
            <td>Kilo byte per second</td>
          </tr>
          <tr>
            <td>maximgsize</td>
            <td>The largest image size</td>
          </tr>
          <tr>
            <td>totalimgsize</td>
            <td>The total size of all images</td>
          </tr>
          <tr>
            <td>totaljssize</td>
            <td>The total size of all JS files</td>
          </tr>
          <tr>
            <td>totalcsssize</td>
            <td>The total size of all CSS files</td>
          </tr>
          <tr>
            <td>browserscaledimg</td>
            <td>The number of images scaled in the browser</td>
          </tr>
          <tr>
            <td>grade</td>
            <td>The sitespeed score</td>
          </tr>
        </tbody>
      </table>

      <p>
        You do that by supplying <strong>-b</strong>
        with the list of column names
      </p>
      <pre>$ ./sitespeed.io -u http://yoursite.com/ -b url,js,css,img,cssimg,font,requests,requestswithoutexpires,docsize,pagesize,criticalpath</pre>
</div>

   
<div class="section">
      <div class="page-header">
      <h2 id="workflow">Workflow</h2>
      </div>
      <p>This is what will happen when you start the script:
  </p>
        <pre>$ ./sitespeed.io -u http://www.cybercom.com/en/</pre>
          <p>
        The script will log what is happening, it will look  something like this:
  </p>
    <pre>
$ Will crawl from start point http://www.cybercom.com/en/ with User-Agent Mozilla/6.0 and viewport 1280x800 with crawl depth 1 ... this can take a while
$ Fetched 20 pages
$ Analyzing http://www.cybercom.com/Investor--Press/
$ Analyzing http://www.cybercom.com/Solutions--services/
$ ...
$ Create result.xml
$ Create the summary.xml
$ Create the summary-details.html
$ Create the pages.html
$ Create the summary index.html
$ Create the assets.html
$ Create the rules.html
$ Finished
</pre>

      <p>
        It will create the following directory structure (the first directory is named after the site you are testing and when the test was executed):
  </p>
        <pre>
sitespeed-result
|
`--www.cybercom.com
    `
    2014-04-16-22-36-36
    |
    | -- css
    |
    | -- data
      | -- result.xml
      ` -- summary.xml
    |
    | -- img
    | -- (images)
    |
    | -- js
    |
    | -- pages
    |
    | -- pages.html
    | -- (pages.csv)
    | -- rules.html
    | -- assets.html
    | -- summary-details.html
    | -- (errorurls.html)
    ` -- index.html
</pre>

      <p>
        The <strong>data</strong>
        directory hold all xml files that's the result from the analyze (the raw data). The <strong>result.xml</strong> contains all the analyzed data for all pages. The 
        <strong>summary.xml</strong> is the XML representation of the summary page. 
         <strong>Pages</strong>
        hold the result (as HTML) for all unique page tests. The
        <strong>pages.html</strong>
        is all pages data, summarized in one page.  The
        <strong>index.html</strong>
        is the summary page, holding information on a high level. Then the <strong>summary-details.html</strong> holds the summary info on a detailed level, here you will see the nitty gritty details of the site.
        <strong>rules.html</strong> is a presentation of the rules used to calculate the score for a page. And the images folder is created if you choose to output the summary as png:s. The <strong>errorurls.html</strong> shows the list of url:s that couldn't be fetched (the file will not exist if all url:s could be collected).
	      The <strong>assets.html</strong> shows the top 200 most used assets across the pages.
      </p>
      <p>The workflow:</p>
      <p class="image">
        <img class="center" alt="sitespeed workflow" src="/img/sitespeed.io-1.6-workflow.png"/>
      </p>
</div>

<div class="section">

      <h2 id="summarypage">Site summary page</h2>
      <p>
        Sitespeed.io creates five different kind of outputs. The summary page is kind of executive summary page where green is good, yellow means that you should look into it and red is bad, sometimes really bad. The page show a summary of best practices for good web site performance.
      </p>
      <p class="image">
        <img src="/img/summary-1.8.jpg" alt="sitespeed summary page" class="img-polaroid"/>
      </p>
</div>

<div class="section">

      <h2 id="detailedsummarypage">The detailed summary page</h2>
      <p>
        The detailed summary page will give you almost all the metrics you want for you site. You will get the average, 10th percentile, median, 95th percentile, min, max and standard deviation value for each metrics (this page is based on the <strong>summary.xml</strong> file, where you also will find the variance and the 90th percentile, if ever needed when comparing metrics). 
      </p>
      <p class="image">
        <img src="/img/summary-details-1.8.png" alt="sitespeed summary page" class="img-polaroid"/>
      </p>
</div>


<div class="section">

      <h2 id="pages">Detailed site report</h2>
      <p>
        The detailed site report page shows data collected for each page. At the moment the following data is showed: Number of javascript/ccs/images/cssimages & font files, total requests, requests missing expire date, the size of the page, the total size of the page (including all assets), the load time of the page, time to first byte, number of single point of failures (and a link to http://webpagetest.org with the assets domains as SPOF, meaning you can easy record a SPOF video) number of javascript loaded synchronously in head and the sitespeed score
        . Click the magnifier to see the response header of the page, and click the URL, to see all the specific collected page data.
      </p>
      <p class="image">
        <img src="/img/pages-1.8.jpg" alt="sitespeed pages page" class="img-polaroid"/>

      </p>
</div>

<div class="section">

      <h2 id="page">Full page analyzis</h2>
      <p>
      Every page that is tested, also get a corresponding html page, where all data is shown. You will see all rules that are below 100, all assets on the page together with the response headers for that asset (click on the magnifier) and a summary. These example images doesn't show everything, checkout the <a href="/example/">examples</a> section to see how it is. 
    </p>
    <p class="image">
      <img src="/img/page-1.6.jpg" alt="sitespeed page page" class="img-polaroid"/>
      </p>
      <p>Scrolling down you will see the page summary:</p>
    <p class="image">
      <img src="/img/page-1.7-b.jpg" alt="sitespeed page summary" class="img-polaroid"/>
      </p>


</div>

<div class="section">


      <h2 id="assets">Most used assets report</h2>
      <p>
        The most used assets report show you the most used assets (a.k.a which asset should you start to change for most bang for the money).
        You wil see the following for each asset: the type, the time since last modification, the cache time, the weight and the number of times the asset has been used.</p>
      <p class="image">
        <img src="/img/assets-1.8.jpg" alt="sitespeed most used asset page" class="img-polaroid"/>
      </p>

</div>



<div class="section">

      <h2 id="junit">Generating the JUnit XML for continuous integration</h2>
       <p>Sitespeed can output <em>junit.xml</em> that works perfect with your continuous integration tool. Jenkins, Bamboo and others support it out of the box.
        To generate the xml, you need to run the script <strong>sitespeed-junit.io</strong> after the normal script (it will take the latest created sitespeed analyze and parse it to the junit.xml).
        The junit script takes the following parameters:</p>
        <pre>
OPTIONS:
-h      Help
-o      The output dir
-r      The result base directory, default is sitespeed-result [optional]
-l      The page score limit. Below this page score it will be a failure. Default is 90. [optional]
-a      The average score limit for all tested pages, below this score it will be a failure. Default is 90. [optional]       
-s      Skip these tests. A comma separeted list of the key name of the tests, for example "ycsstop,yjsbottom" [optional]
        </pre> 
   <p><em>Note:</em> the key name used when skip the tests, is viewed in the the Jenkins result, check the title for each page, the key is the name before the colon, for example <em>ynumreq: Make fewer HTTP requests</em> where <strong>ynumreq</strong> is the key.
  </p>

</div>


<div class="section">
      <h2 id="jenkins">Jenkins integration</h2>
     <a href="http://jenkins-ci.org/" target="_blank">Jenkins</a> is a great open source continuous integration server.
   <p>
    To get sitespeed.io up and running, you need to make sure that the user in <strong>Jenkins</strong> that runs the job, have <a>PhantomJs</a> in the path and
    have read/write access to the directory where you have sitespeed. When you have that, you are ready to set it up.
  </p>
  <p>
    In Jenkins, add a new <em>Execute shell</em> and add the two script on one line each. The first one is the standard script, and the second one will create the junit.xml, make sure to pipe the output to a file, so Jenkins can find it.</p>
        <pre>
/Users/peter/tmp/sitespeed.io -u http://yoursite.com
/Users/peter/tmp/sitespeed-junit.io -o /Users/Shared/Jenkins/Home/workspace/sitespeed.io/
        </pre>
        <p>Then add a <em>Post-build Action</em> that will publish the JUnit test result report, and choose the output file from the script. In Jenkins, this is how it looks:
      </p>
        <p class="image">
        <a href="jenkins-sitespeed-config.png"><img src="jenkins-sitespeed-config.png" alt="Configuration Sitespeed.io for Jenkins" class="img-polaroid"/></a>
      </p>

       <p class="image">
          
        <a href="jenkins-junit-setup.png"><img src="jenkins-junit-setup.png" alt="Configuration JUnit.xml file" class="img-polaroid"/></a>
      </p>

      <p>Each sitespeed test, is a JUnit testcase, each page tested is a testsuite and the whole test bundled as testsuites. The cool thing is that you will get a good overview: you can see the failures for all pages, and you can also drill down the result page by page.

      </p>
       <p class="image">
       <a href="jenkins-test-all-pages.jpg"><img src="jenkins-test-all-pages.jpg" alt="All the tested pages" class="img-polaroid"/></a>
      </p>

      <p>
        And for a specific page:</p>
       <p class="image">
        <a href="jenkins-tests-for-one-page-full.jpg"><img src="jenkins-tests-for-one-page.jpg" alt="One full test" class="img-polaroid"/></a>
      </p>

      <p>Running the sitespeed JUnit script, will also copy the <em>summary.xml</em> file to the output directory. Using the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Plot+Plugin" target="_blank">Jenkins plot plugin</a> will then create graphs between builds of the metrics you choose (and you can choose between all that you have in the <a href="summary-1.8.1.xml">summary.xml</a> file. For every metric you want, add the xpath to the value you want to fetch. If you want to fetch the median value of the page weight, add the XPath <strong>//site/metrics/pageweight/median</strong>.</p>
<p class="image">
   <a href="jenkins-plot-setup.png"><img src="jenkins-plot-setup.png" alt="Setup the plot plugin" class="img-polaroid"/></a>
</p>

<p>And the graphs:</p>
<p class="image">
<a href="plot-graph-example.png"><img src="plot-graph-example.png" alt="The graph" class="img-polaroid"/></a>
</p>


  </div>

<div class="section">

      <h2 id="travis">Travis integration</h2>
      <p>
      <a href="https://travis-ci.org/" target="_blank">Travis</a> doesn't have a built in support for JUnit XML right now (read this  
      <a href="https://github.com/travis-ci/travis-ci/issues/239" target="_blank">issue</a> about the plan for supporting it).
      But you can of course use it and break the build if you have failures.
      </p>
      
      <p>Setup your <strong>.travis.yml</strong> file (before you run the <em>before_script</em> you need to start your server (that is not included), in this example the server runs on http://127.0.0.1:8080/.
      <pre>
before_install:
- sudo apt-get update
- sudo apt-get install xsltproc
        
before_script:
- "./sitespeed.io/sitespeed.io -u http://127.0.0.1:8080/"
- "./sitespeed.io/sitespeed-junit.io -o ../../../../"

script: ./verify-junit.sh sitespeed.io-junit.xml 
</pre>

The <strong>verify-junit.sh</strong> script is a simple script that fails if it find the failure tag (but of course you can do more cool things if you want, 
this is just a super simple example):
<pre>
#! /bin/bash
JUNIT_XML=$1
 if grep -c "&lt;/failure&gt;" "$JUNIT_XML" > 0; 
 then
   FAILURES=$(grep -o "&lt;/failure"&gt;" $JUNIT_XML | wc -l)
   echo "We have a $FAILURES failure(s)"
   cat $JUNIT_XML
   exit 1;
 else
  echo 'No failures from sitespeed.io'
 fi   
</pre>      
      
      </div>


<!--
<div class="section">
  <div class="row-fluid">
    <div class="span12">
      <div class="page-header">
      <h2 id="csv">Export as CSV</h2>
    </div>
    <p>You can export the data showed on the <a href="pages">detailed site report</a> as a plain CSV file. The CSV file is a comma separated list, tested in Excel & Open Office. To generate the CSV file, use the 
      <a href="imgandcsv"></a>

      #pages Detailed site report
    </p>

    </div>
</div>
</div>
-->
<div class="section">

      <div class="page-header">
      <h2 id="developers">Developers</h2>
    </div>
    <p style="word-wrap: break-word;">
    You can fork the project at <a href="https://github.com/soulgalore/sitespeed.io" target="_blank">https://github.com/soulgalore/sitespeed.io</a> and create 
    your own version or contribute to the existing one. There are two branches: <strong>master</strong> is the latest release. No development happens in master. The other branch is <strong>versionnumber-wip</strong>, meaning <strong>2.0-wip</strong> that are the branch that is work in progress, and the next coming release.  
    </p>

    </div>



<div class="section">

      <div class="page-header">
      <h2 id="dependencies" style="word-wrap: break-word;">Dependencies</h2>
    </div>
      <p>
        Here are the dependencies for running sitespeed.io:
      </p>
      <dl class="dl-horizontal">
        <dt>Linux/Unix</dt>
        <dd>Linux/Unix or a Linux-like environment for Windows like Git Bash.</dd>

        <dt>PhantomJS</dt>
      <dd><a href="http://phantomjs.org/" target="_blank">PhantomJS</a> is a headless WebKit with JavaScript API. It is really cool product where you can do browser things without a browser. You need to have it installed to be able to run sitespeed.io.</dd>

      <dt>Java 1.6</dt>
      <dd>You need to have Java 1.6 (or higher) installed because many components used are written in Java.</dd>
    
      <dt>cURL</dt>
        <dd>cURL is used to fetch the time to first byte and the size of a gzipped page.</dd>
        <dt>xsltproc</dt>
        <dd>xsltproc is used to match the JUnit XSL file with the XML result from the analyze to create the JUNit XML file</dd>

        </dl>
</div>

<div class="section">
      <div class="page-header">
      <h2 id="components">Components</h2>
</div>

      <p>The following components are used by sitespeed.io:</p>
      <dl class="dl-horizontal">
         <dt>YSlow</dt> 
      <dd>Sitespeed.io uses the rule engine of <a href="http://yslow.org" target="_blank">Yslow</a>, because it is great! YSlow was originally developed by Yahoo and now maintained by <strong>Marcel Duran</strong>, a rule engine & browser plugin created to test your web page against <a href="http://yslow.org/#web_performance_best_practices_and_rules" target="_blank">best practices rules</a>. The version used is the <a href="https://github.com/marcelduran/yslow/wiki/PhantomJS" target="_blank">Yslow/PhantomJs</a> version. Sitespeed uses it own ruleset of best practice performance rules, and the code can be found  <a href="https://github.com/soulgalore/yslow/blob/master/src/common/rulesets/ruleset_sitespeed.js" target="_blank">here</a>.</dd>
      <dt>Twitter Bootstrap</dt>
      <dd><a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a> is a front end framework to create nice looking HTML, all the front end of the result pages produced by sitespeed are built with Bootstrap.</dd>
      <dt>HTMLCompressor</dt>
      <dd>The <a href="http://code.google.com/p/htmlcompressor/" target="_blank">HTMLCompressor</a> Compress/minifies the HTML result pages, to do them as clean & small as possible.</dd>
      <dt>Velocity</dt>
      <dd><a href="http://velocity.apache.org/" target="_blank">Apache Velocity</a> is an (old but great  Java template engine, the reason it is used, it because gives the possibility of getting hold of whatever Java library that is needed to do things in the front end. The statistics calculated on the summary page (median & averages) are using the Apache Commons <a href="http://commons.apache.org/math/" target="_blank">Math library</a>. </dd>
      <dt>Crawler</dt>
      <dd>This is a simple  <a href="https://github.com/soulgalore/crawler" target="_blank">Java crawler</a> that output all links within a domain to a file, it can follow a specific path or make sure urls containing X not will be fetched. In the backend it uses Java:s best HTTP framework: <a href="http://hc.apache.org/" target="_blank">HttpComponents</a> that makes sure it can pretty sure do whatever you want.</dd>
      <dt>XMLToVelocity</dt>
      <dd><a href="https://github.com/soulgalore/xml-velocity" target="_blank">XMLToVelocity</a> is a small Java component that parses a XML-file with a Velocity template.</dd>
      <dt>Stupid Table Plugin</dt>
      <dd><a href="https://github.com/joequery/Stupid-Table-Plugin" target="_blank">Stupid Table Plugin</a> is a really small table column sorter (yes two different is used today, one needs to go away).</dd>

      </dl>

</div>


<div class="section">
      <div class="page-header">
      <h2 id="feature" style="word-wrap: break-word;">Create a new feature/improvement request</h2>
    </div>
    <p>
      If you have ideas of how sitespeed.io can be improved or if you have any features that you think is missing, please add it to the <a href="https://github.com/soulgalore/sitespeed.io/issues?labels=&milestone=&page=1&state=open" target="_blank">issue list</a>.
    </p>

    </div>


<div class="section">
      <div class="page-header">
      <h2 id="bug">Report a bug</h2>
    </div>
    <p style="word-wrap: break-word;">
     If you find a bug, go through the current known bug list <a href="https://github.com/soulgalore/sitespeed.io/issues?labels=bug&state=open" target="_blank">https://github.com/soulgalore/sitespeed.io/issues?labels=bug&state=open</a>. If it doesn't exist there, please add it!
    </p>

    </div>


<div class="section">
      <div class="page-header">
      <h2 id="addrule">Add your own rules</h2>
    </div>
    <p style="word-wrap: break-word;">
      Sitspeed uses <a href="http://yslow.org/" target="_blank">Yslow</a> as the engine for creating and managing the rules that decides how good the web page is optimized for performance.  <a href="https://twitter.com/stoyanstefanov" target="_blank">Stoyan Stefanov</a> has written three good blog posts of how you develop and write rules for Yslow:
    </p>
      <ul>
        <li><a href="http://www.phpied.com/yslow-development-getting-started/" target="_blank">Getting started</a></li>
        <li><a href="http://www.phpied.com/yslow-development-setup/" target="_blank">Setup</a></li>
        <li><a href="http://www.phpied.com/yslow-development-custom-rulesets/" target="_blank">Custom ruleset</a></li>
      </ul>

      <p>
      To do it for sitespeed, this is what you need:
      </p>
      <ol>
        <li><p>Clone the project: 
          <pre>git clone git@github.com:soulgalore/yslow.git</pre>
        </p>
        </li>
        <li><p style="word-wrap: break-word;">There are two files that you need to change, first the rule file, where you actually add your own rule:
          <a href="https://github.com/soulgalore/yslow/blob/master/src/common/rulesets/ruleset_sitespeed.js" target="_blank">https://github.com/soulgalore/yslow/blob/master/src/common/rulesets/ruleset_sitespeed.js</a>. </p>

          <p>You need to do two changes: Add your rule <i>YSLOW.registerRule(...)</i> and register your rule to the ruleset <i>YSLOW.registerRuleset(...)</i></p>
          <p>In this example, I will add a rule called <b>cssprint</b> that will check for css files used only for printing the page:</p>
<pre class="prettyprint">
YSLOW.registerRule({
id: 'cssprint',
name: 'Do not load print stylesheets, use @media type print instead',
info: 'Loading a specific stylesheet for printing slows down the page, ' +
      'even though it is not used',
category: ['css'],
config: {points: 20},
url: 'http://sitespeed.io/rules/#cssprint',

lint: function (doc, cset, config) {
var i, media, score,url,
      offenders = [],
      hash = {},
      comps = cset.getComponentsByType('css'),
      links = doc.getElementsByTagName('link');

       for (i = 0, len = links.length; i < len; i += 1) {

        if (links[i].media === 'print') {
          url = links[i].href;           
          hash[url] = 1;
        }
      }

   for (var i = 0; i < comps.length; i++) {
    if (hash[comps[i].url]) {
      offenders.push(comps[i]);
    }
  }
    score = 100 - offenders.length * parseInt(config.points, 20);
    
    return {
    score: score,
    message: (offenders.length > 0) ? YSLOW.util.plural(
        'There %are% %num% print css files included on the page, that should be @media query instead',
        offenders.length
    ) : '',
    components: offenders
  };
 }
});  
</pre>

<p>When you have written your rule, register it to the ruleset and give it a proper weight (the lines with <b>cssprint</b> are the new ones, the rest exists already:</p>

<pre>
YSLOW.registerRuleset({ 
  id: 'sitespeed.io-X.Y',
  name: 'Sitespeed.io rules vX.Y',
  rules: {
  ...
 cssprint: {},
 ...
 weights: {
 ...
 cssprint: 3,
 ...
 </pre>

        </li>

        <li><p style="word-wrap: break-word;">The next step is adding the documentation for the rule, you do that in the file: <a href="https://github.com/soulgalore/yslow/blob/master/src/common/doc.js" target="_blank">https://github.com/soulgalore/yslow/blob/master/src/common/doc.js</a>.</p> <p>You add one row where you put in the rule info:
          <pre>YSLOW.doc.addRuleInfo('rulename','title','description')</pre>

          For the <b>cssprint</b> rule, it looks like this:
          <pre>YSLOW.doc.addRuleInfo('cssprint','Avoid loading specific css for print','Loading a specific stylesheet for print, can block rendering in your browser (depending on browser version) and will for almost all browsers, block the onload event to fire (even though the print stylesheet is not even used!).');
          </pre>

         It is used when you run sitespeed to create the rule definition HTML file that is put into the results, so you always can backtrack which rules you use. </p>
        </li>
        <li>Create the new Yslow javascript file: <pre>make phantomjs</pre></li>
        <li>Test that it works on one url (standing in root for Yslow): <pre>phantomjs build/phantomjs/yslow.js d -r sitespeed.io-1.8.3 -f xml http://yoururl.com</pre></li>
        <li>Move the newly created rulefile into your dependencies directory for sitespeed, on my local I do it this way:
          <pre>cp build/phantomjs/yslow.js ../sitespeed.io/dependencies/yslow-3.1.5-sitespeed.js</pre>
         </li>
         <li>Run sitespeed: <pre>./sitespeed.io -u http://yoururl.com</pre></li>
       </ol>
          

    </div>
</div>

        


